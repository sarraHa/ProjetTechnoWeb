<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
        <title>registration page</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
        <style>
			body{
				background: url("https://agence-autrement.com/wp-content/uploads/2014/12/AWD_3D_-3Fond_1900.jpg") no-repeat center fixed;
				background-size: cover;
				display: flex;
				align-items: 50%;
				height: 80vh;
			}
        </style>
    </head>
    <body style="max-width: 350px; margin: 0 auto;">
        <div class="container-fluid text-center">
            <div>
                <img src="https://www.1pcom.net/img/loginhead.jpg" style="max-width: 350px; margin: 0 auto; padding-top: 25px; padding-bottom:25px">
            </div>

            <form id="registrationForm" th:action="@{/registration}" th:object="${user}" method="post">
                <div class="border border-secondary p-3 rounded">
                    <p><input  onchange="fermerErreur()" id="login" type="text" th:field="*{login}" name="username" class="form-control" placeholder="Nom de compte"/></p>
                    <p><input onchange="fermerErreur()" id="mdp" type="password" th:field="*{mdp}" name="password" class="form-control" placeholder="Mot de passe"/></p>
                    <p><input onchange="fermerErreur()" id="confirm" type="password" name="passwordConfirm" class="form-control" placeholder="Confirmer votre mot de passe"/></p>
                    <p id="erreurMdp" style="display: none; color: red;"> Les mots de passes sont différents.</p>
                    <p id="formVide" style="display: none; color: red;"> Vous devez remplir tous les éléments du formulaire!</p>
                </div>
            </form>
            <br/>
            <button onclick="verificationFormulaire()" id="validerForm" class="btn btn-primary">Valider</button><br/>
            <a href="/login" >Deja inscrit? Connectez vous</a>
        </div>
    </body>
</html>

<script>
    function verificationFormulaire() {  // On reste très basique ici par manque de temps
        mdp = document.getElementById("mdp").value;
        mdpConfirm = document.getElementById("confirm").value;
        login = document.getElementById("login").value;
        if(mdp != mdpConfirm){
            document.getElementById("erreurMdp").style.display = "inline";
        }else if(mdp.trim()== "" || mdpConfirm.trim() == "" || login.trim() == ""){
            document.getElementById("formVide").style.display = "inline";
        }else{
            document.getElementById("registrationForm").submit();
        }
    }

    function fermerErreur(){
        document.getElementById("erreurMdp").style.display = "none";
        document.getElementById("formVide").style.display = "none";
    }
</script>